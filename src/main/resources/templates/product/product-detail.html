<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link th:href="@{/css/product-detail.css}" type="text/css" rel="stylesheet">
    <link th:href="@{/css/bootstrap.min.css}" type="text/css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/header.css}">
</head>
<body>
<div th:replace="/layout/header :: header"></div>
<div class="container">
    <div class="product-detail mt-2">
        <div class="product-image">
            <img th:each="image : ${product.productImages} " th:style="'width: 300px' "
                 th:src="@{${image.imageUrl}}" alt="Product Image" class="card-img-top product-image"/>
        </div>
        <div class="product-info">
            <h1 class="h1 mb-1" th:text="${product.productName}"></h1>
            <div class="fs-5 mb-5">
                <span class=" h4 text-decoration-line-through" th:text="${formattedPrices}"></span>
            </div>
            <p class="lead product-description">
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Praesentium at dolorem quidem modi. Nam sequi consequatur obcaecati excepturi alias magni, accusamus eius blanditiis delectus ipsam minima ea iste laborum vero?
            </p>
            <div class="quantity-add">
                <input class="form-control" id="inputQuantity" type="number" value="1">
                <form th:action="@{/add-to-cart}" class="add-to-cart-form" method="post">
                    <input type="hidden" name="productId" th:value="${product.productId}"/>
                    <button class="btn btn-add-to-cart" type="submit">
                        <img class="shopping-cart" th:src="@{/img/shopping-cart.svg}" alt="Product Image">
                        Add to cart
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('.btn-add-to-cart').click(function (e) {
            e.preventDefault(); // Ngăn chặn hành động mặc định của sự kiện click

            var form = $(this).closest('.add-to-cart-form'); // Tìm form bên trong nút được click
            var formData = form.serialize(); // Chuyển đổi form thành dữ liệu chuỗi

            // Perform AJAX request to add product to cart
            $.ajax({
                type: "POST",
                url: form.attr('action'),
                data: formData,
                success: function (response) {
                    console.log('Sản phẩm đã được thêm vào giỏ hàng.', response);
                    // Redirect to the cart page after successful addition
                    window.location.href = '/cart';
                },
                error: function (xhr, status, error) {
                    console.error('Lỗi khi thêm sản phẩm vào giỏ hàng.', error);
                    // Handle error case if needed
                }
            });
        });
    });
    document.addEventListener('DOMContentLoaded', function () {
        const slides = document.querySelectorAll('.custom-content-slide .content-slide');

        slides.forEach(slide => {
            slide.addEventListener('click', function () {
                slides.forEach(s => s.classList.remove('active')); // Loại bỏ lớp active từ tất cả các slide
                this.classList.add('active'); // Thêm lớp active vào slide được click
            });
        });
    });
</script>
</body>
</html>